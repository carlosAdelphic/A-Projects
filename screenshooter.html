<!DOCTYPE html>
<html>
<head>
	<script type="text/javascript" src="html2canvas.js"></script>
	<script type="text/javascript">
		
	function previewCreative (creative_tag)
	{


		

		//we add the button for screenshoting the creative
		/*
		var screenshot_btn = "<button style=\"margin-left:15px\" type=\"Preview_Button\" onclick=\"generateScreenshot()\">Take Screenshot of Creative</button>"
		document.getElementById("buttons_cell").innerHTML += screenshot_btn;*/

		//Celtra preview URL
		var celtra_id = iframe_width;
		var celtra_url = "<div class=\"celtra-ad-v3\" style=\"z-index: 1;\"><img src=\"data:image/png,celtra\" style=\"display: none\" onerror=\"(function(img) {var params = {&quot;purpose&quot;:&quot;preview&quot;,&quot;overrides.clientTimestamp&quot;:null,&quot;overrides.clientTimeZoneOffsetInMinutes&quot;:null,&quot;overrides.ipCityGeonameId&quot;:null,&quot;overrides.ipPrincipalSubdivisionCode&quot;:null,&quot;overrides.ipRegionCode&quot;:null,&quot;overrides.ipCity&quot;:null,&quot;overrides.ipCountryCode&quot;:null,&quot;overrides.weather.currentCondition&quot;:null,&quot;overrides.weather.apparentTemperature&quot;:null,&quot;overrides.weather.windy&quot;:null,&quot;overrides.customAudiences&quot;:null,&quot;overrides.deviceInfo.osName&quot;:null,&quot;overrides.placementId&quot;:null};var req = document.createElement(&quot;script&quot;);req.id = params.scriptId = &quot;celtra-script-&quot; + (window.celtraScriptIndex = (window.celtraScriptIndex||0)+1);params.clientTimestamp = new Date/1000;params.clientTimeZoneOffsetInMinutes = new Date().getTimezoneOffset();var src = (window.location.protocol == &quot;https:&quot; ? &quot;https&quot; : &quot;http&quot;) + &quot;:\/\/ads.celtra.com\/"+celtra_id+"\/preview.js?&quot;;for (var k in params) {src += &quot;&amp;&quot;+encodeURIComponent(k)+&quot;=&quot;+ encodeURIComponent(params[k]);}req.src = src;img.parentNode.insertBefore(req, img.nextSibling);})(this);\"><script id=\"celtra-script-1\" src=\"http://ads.celtra.com/"+celtra_id+"/preview.js?&amp;purpose=preview&amp;overrides.clientTimestamp=null&amp;overrides.clientTimeZoneOffsetInMinutes=null&amp;overrides.ipCityGeonameId=null&amp;overrides.ipPrincipalSubdivisionCode=null&amp;overrides.ipRegionCode=null&amp;overrides.ipCity=null&amp;overrides.ipCountryCode=null&amp;overrides.weather.currentCondition=null&amp;overrides.weather.apparentTemperature=null&amp;overrides.weather.windy=null&amp;overrides.customAudiences=null&amp;overrides.deviceInfo.osName=null&amp;overrides.placementId=null&amp;scriptId=celtra-script-1&amp;clientTimestamp=1493413389.444&amp;clientTimeZoneOffsetInMinutes=-60\">\</script><script src=\"http://cache.celtra.com/api/creatives/"+celtra_id+"/compiled/preview.js?v=28-38bfc9f8fc&amp;secure=0&amp;inmobi=0\">\</script></div>";

		document.getElementById('tag_loader').contentWindow.document.write(celtra_url);



	}

	function generateScreenshot()
	{
		var loader = document.getElementById('creativeLoader').contentWindow.document.body;

		console.log(loader)


		
/*
		html2canvas(loader, {
		  onrendered: function(canvas) {
		  	console.log("generating")
		    document.getElementById("screenshot").innerHTML = canvas;
		  },
		  width: Number(document.getElementById('width').value),
		  height: Number(document.getElementById('height').value)
		});*/

		html2canvas(loader, {
		  onrendered: function(canvas) {
		  	console.log("Rendered")
		    document.body.appendChild(canvas);
		  },
		  width: 600,
		  height: 600
		});


	}


	</script>
</head>
<body>

	<header role="banner" id="header" style="margin-top: 20px; margin-left: 15px">
		<div id="logo"><a title="Mobile and cross-device demand side platform" href="http://adelphic.com"><img src="http://adelphic.com/wp-content/themes/adelp/images/adelphic-logo.png"/></a></div>
		<div id="title"><h1>Creative Screenshot Generator v1.0</h1></div>
	</header>

	<table style="width:550px; margin-left: 15px">
	  <tr>
	    <td><p style="font-size:14px">Creative width: </p></td>
	    <td><textarea name="width" id="width" style="font-size:12px; vertical-align:top; width:40px; height:15px"></textarea></td>
	  </tr>
	  <tr>
	    <td><p style="font-size:14px">Creative height: </p></td>
	    <td><textarea name="height" id="height" style="font-size:12px; vertical-align:top; width:40px; height:15px"></textarea></td>
	  </tr>
	  <tr>
	  	<td><p style="font-size:14px">Creative tag: </p></td>
	  	<td><textarea name="tag" id="tag" style="vertical-align:top; width:400px; height:155px"></textarea></td>
	  </tr>
	   <tr>
	  	<td></td>
	  	<td style="text-align: left" id="buttons_cell"><button type="Preview_Button" onclick="previewCreative(document.getElementById('tag').value)">Preview Creative</button></td>
	  </tr>
	</table>

	<table style="width:550px; margin-left: 15px">
	  <tr>
	  	<td><p style="font-size:14px">Preview: </p></td>
	  	<td><p style="font-size:14px">Static screenshot: </p></td>
	  </tr>
	  <tr>
	  	<td style="text-align: left" id="preview">
  
	  		<iframe src="tag_loader.html" scrolling="no" name="tag_loader" id="tag_loader" data-field="ad" width="320px" allowfullscreen="" height="480px" frameBorder="0" style="padding: 0; overflow: hidden"></iframe>
	  		
	  		
	  	</td>
	  	<td style="text-align: left" id="screenshot"></td>
	  </tr>
	  
	  <tr style="height: 40px; font-size: 14px; vertical-align:bottom; "">
	  	<td colspan="2">Not working or having an issue?Let us know <a href="mailto:carlos@adelphic.com?subject=Issues with my tag&body=Please remember to add the tag you're having issues with here">here</a></td>
	  </tr>
	  <tr style="height: 20px; font-size: 14px; vertical-align:bottom; ">
	  	<td colspan="2"><a href="versioncontrol.html" target="_blank">Version control</a></td>
	  </tr>
	</table>

</body>
</html>